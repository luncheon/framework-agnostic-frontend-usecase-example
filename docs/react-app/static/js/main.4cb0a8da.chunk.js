(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,n,t){},15:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),l=t(2),o=t.n(l),c=t(6),d=t(3),u=t(4),s=t(5),i=function(){function e(n){Object(u.a)(this,e),this.update=n}return Object(s.a)(e,[{key:"setActiveCellAddress",value:function(e,n){return this.update(function(t){var r=t.maxCellAddress,a=t.activeCellAddress;"number"===typeof e&&e>=0&&e<=r.rowIndex&&(a.rowIndex=e),"number"===typeof n&&n>=0&&n<=r.columnIndex&&(a.columnIndex=n)}),this}},{key:"moveActiveCellAddress",value:function(e,n){return this.update(function(t){var r=t.maxCellAddress,a=t.activeCellAddress;"number"===typeof e&&e&&(a.rowIndex=Math.min(Math.max(0,a.rowIndex+e),r.rowIndex)),"number"===typeof n&&n&&(a.columnIndex=Math.min(Math.max(0,a.columnIndex+n),r.columnIndex))}),this}},{key:"setActiveCellContent",value:function(e){return this.update(function(n){var t=n.activeCellAddress,r=t.rowIndex,a=t.columnIndex,l=n.cellContents;if(e)l[r]=l[r]||[],l[r][a]=e;else{var o=l[r];if(!o||!o[a])return;for(delete l[r][a];o.length&&!o[o.length-1];)o.pop();if(o.length)return;for(delete l[r];l.length&&!l[l.length-1];)l.pop()}}),this}}]),e}(),m=function(e,n){for(var t=Array(e+1),r=0;r<=e;r++)t[r]=n(r);return t},v=a.a.memo(function(e){var n=e.rowIndex,t=e.columnIndex,r=e.active,l=e.content;return a.a.createElement("td",{className:r?"active":"","data-row-index":n,"data-column-index":t},r?a.a.createElement("input",{defaultValue:l,autoFocus:!0}):l)}),f=a.a.memo(function(e){var n=e.rowIndex,t=e.row,r=e.activeCellIndex,l=e.maxColumnIndex;return a.a.createElement("tr",null,a.a.createElement("th",null,n),m(l,function(e){return a.a.createElement(v,{key:e,rowIndex:n,columnIndex:e,active:e===r,content:t&&t[e]})}))}),x=a.a.memo(function(e){var n=e.maxColumnIndex;return a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null),m(n,function(e){return a.a.createElement("th",{key:e},e)})))}),w=function(e){var n=e.worksheet,t=n.maxCellAddress,r=n.activeCellAddress,l=n.cellContents,o=e.worksheetOperations;return a.a.createElement("table",{className:"worksheet"},a.a.createElement(x,{maxColumnIndex:t.columnIndex}),a.a.createElement("tbody",{onClick:a.a.useCallback(function(e){var n=e.target.dataset;o.setActiveCellAddress(+n.rowIndex,+n.columnIndex)},[]),onChange:a.a.useCallback(function(e){e.target instanceof HTMLInputElement&&o.setActiveCellContent(e.target.value)},[])},m(t.rowIndex,function(e){return a.a.createElement(f,{key:e,rowIndex:e,row:l[e],activeCellIndex:e===r.rowIndex?r.columnIndex:void 0,maxColumnIndex:t.columnIndex})})))};t(14);o.a.render(a.a.createElement(function(){var e=a.a.useState({maxCellAddress:{rowIndex:99,columnIndex:99},activeCellAddress:{rowIndex:0,columnIndex:0},cellContents:[]}),n=Object(c.a)(e,2),t=n[0],r=n[1],l=new i(function(e){return r(Object(d.a)(e))});return a.a.useEffect(function(){var e,n=(e=l,function(n){switch(n.key){case"ArrowDown":n.preventDefault(),e.moveActiveCellAddress(1);break;case"ArrowLeft":n.preventDefault(),e.moveActiveCellAddress(0,-1);break;case"ArrowRight":n.preventDefault(),e.moveActiveCellAddress(0,1);break;case"ArrowUp":n.preventDefault(),e.moveActiveCellAddress(-1);break;case"Tab":n.preventDefault(),e.moveActiveCellAddress(0,n.shiftKey?-1:1);break;case"Enter":n.preventDefault(),e.moveActiveCellAddress(n.shiftKey?-1:1)}});return window.addEventListener("keydown",n),function(){return window.removeEventListener("keydown",n)}},[]),a.a.createElement(w,{worksheet:t,worksheetOperations:l})},null),document.body.appendChild(document.createElement("main")))},7:function(e,n,t){e.exports=t(15)}},[[7,1,2]]]);
//# sourceMappingURL=main.4cb0a8da.chunk.js.map