{"version":3,"sources":["webpack:////Users/takeuchi.kazuto/projects/framework-agnostic-frontend-usecase-example/usecase/es/Worksheet.js","webpack:////Users/takeuchi.kazuto/projects/framework-agnostic-frontend-usecase-example/usecase/es/WorksheetOperations.js","webpack:////Users/takeuchi.kazuto/projects/framework-agnostic-frontend-usecase-example/usecase/es/index.js","webpack:///../common/createWorksheet.ts","webpack:///../common/createWorksheetKeyEventHandler.ts","webpack:///./$_lazy_route_resource lazy namespace object","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/shared/auto-focus.directive.ts","webpack:///./src/app/shared/range.pipe.ts","webpack:///./src/app/shared/shared.module.ts","webpack:///./src/app/worksheet.component.ts","webpack:///./src/app/worksheet.services.ts","webpack:///./src/environments/environment.ts","webpack:///./src/main.ts"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["export const createEmptyWorksheet = ({ maxCellAddress }) => ({\n    maxCellAddress,\n    activeCellAddress: { rowIndex: 0, columnIndex: 0 },\n    cellContents: [],\n});\n","export class WorksheetOperations {\n    constructor(update) {\n        this.update = update;\n    }\n    setActiveCellAddress(rowIndex, columnIndex) {\n        this.update(({ maxCellAddress, activeCellAddress }) => {\n            if (typeof rowIndex === 'number' && rowIndex >= 0 && rowIndex <= maxCellAddress.rowIndex) {\n                activeCellAddress.rowIndex = rowIndex;\n            }\n            if (typeof columnIndex === 'number' && columnIndex >= 0 && columnIndex <= maxCellAddress.columnIndex) {\n                activeCellAddress.columnIndex = columnIndex;\n            }\n        });\n        return this;\n    }\n    moveActiveCellAddress(rowOffset, columnOffset) {\n        this.update(({ maxCellAddress, activeCellAddress }) => {\n            if (typeof rowOffset === 'number' && rowOffset) {\n                activeCellAddress.rowIndex = Math.min(Math.max(0, activeCellAddress.rowIndex + rowOffset), maxCellAddress.rowIndex);\n            }\n            if (typeof columnOffset === 'number' && columnOffset) {\n                activeCellAddress.columnIndex = Math.min(Math.max(0, activeCellAddress.columnIndex + columnOffset), maxCellAddress.columnIndex);\n            }\n        });\n        return this;\n    }\n    setActiveCellContent(content) {\n        this.update(({ activeCellAddress: { rowIndex, columnIndex }, cellContents }) => {\n            if (content) {\n                cellContents[rowIndex] = cellContents[rowIndex] || [];\n                cellContents[rowIndex][columnIndex] = content;\n            }\n            else {\n                const row = cellContents[rowIndex];\n                if (!row || !row[columnIndex]) {\n                    return;\n                }\n                delete cellContents[rowIndex][columnIndex];\n                while (row.length && !row[row.length - 1]) {\n                    row.pop();\n                }\n                if (row.length) {\n                    return;\n                }\n                delete cellContents[rowIndex];\n                while (cellContents.length && !cellContents[cellContents.length - 1]) {\n                    cellContents.pop();\n                }\n            }\n        });\n        return this;\n    }\n}\n","export * from './Worksheet';\nexport * from './WorksheetOperations';\n","import { createEmptyWorksheet } from '../../usecase'\n\nexport default () => createEmptyWorksheet({\n  maxCellAddress: {\n    rowIndex: 99,\n    columnIndex: 99,\n  }\n})\n","import { WorksheetOperations } from '../../usecase'\n\nexport default (operations: WorksheetOperations) => (event: KeyboardEvent) => {\n  switch (event.key) {\n    case 'ArrowDown':\n      event.preventDefault()\n      operations.moveActiveCellAddress(1)\n      break\n    case 'ArrowLeft':\n      event.preventDefault()\n      operations.moveActiveCellAddress(0, -1)\n      break\n    case 'ArrowRight':\n      event.preventDefault()\n      operations.moveActiveCellAddress(0, 1)\n      break\n    case 'ArrowUp':\n      event.preventDefault()\n      operations.moveActiveCellAddress(-1)\n      break\n    case 'Tab':\n      event.preventDefault()\n      operations.moveActiveCellAddress(0, event.shiftKey ? -1 : 1)\n      break\n    case 'Enter':\n      event.preventDefault()\n      operations.moveActiveCellAddress(event.shiftKey ? -1 : 1)\n      break\n    default:\n      break\n  }\n}\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { Component } from '@angular/core'\n\n@Component({\n  selector: 'app-root',\n  template: `<app-worksheet></app-worksheet>`,\n})\nexport class AppComponent {}\n","import { BrowserModule } from '@angular/platform-browser'\nimport { NgModule } from '@angular/core'\n\nimport { SharedModule } from './shared/shared.module'\n\nimport { AppComponent } from './app.component'\nimport { WorksheetComponent } from './worksheet.component'\nimport { WorksheetService } from './worksheet.services'\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    WorksheetComponent,\n  ],\n  imports: [\n    BrowserModule,\n    SharedModule,\n  ],\n  providers: [\n    WorksheetService,\n  ],\n  bootstrap: [AppComponent],\n})\nexport class AppModule {}\n","import { Directive, ElementRef, AfterViewInit } from '@angular/core'\n\n@Directive({\n  selector: '[appAutoFocus]',\n})\nexport class AutoFocusDirective implements AfterViewInit {\n  constructor(private elementRef: ElementRef<HTMLElement>) {}\n\n  ngAfterViewInit() {\n    this.elementRef.nativeElement.focus()\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core'\n\n@Pipe({ name: 'appRange' })\nexport class RangePipe implements PipeTransform {\n  transform(end: number) {\n    return [...Array(end)].map((_, index) => index)\n  }\n}\n","import { NgModule } from '@angular/core'\nimport { RangePipe } from './range.pipe'\nimport { AutoFocusDirective } from './auto-focus.directive'\n\n@NgModule({\n  declarations: [\n    AutoFocusDirective,\n    RangePipe,\n  ],\n  exports: [\n    AutoFocusDirective,\n    RangePipe,\n  ],\n})\nexport class SharedModule {}\n","import { Component, ChangeDetectionStrategy, OnInit, OnDestroy } from '@angular/core'\nimport { Observable } from 'rxjs'\nimport { map, shareReplay, pluck, distinctUntilChanged, take, tap } from 'rxjs/operators'\nimport { WorksheetService } from './worksheet.services'\nimport createWorksheetKeyEventHandler from '../../../common/createWorksheetKeyEventHandler'\n\n@Component({\n  selector: 'app-worksheet',\n  template: `\n    <table class=\"worksheet\" *ngIf=\"worksheet$ | async as worksheet\">\n      <thead>\n        <tr>\n          <th></th>\n          <th *ngFor=\"let columnIndex of worksheet.maxCellAddress.columnIndex + 1 | appRange\">{{columnIndex}}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let rowIndex of worksheet.maxCellAddress.rowIndex + 1 | appRange\">\n          <th>{{rowIndex}}</th>\n          <ng-container *ngFor=\"let columnIndex of worksheet.maxCellAddress.columnIndex + 1 | appRange\">\n            <ng-content *ngTemplateOutlet=\"cellTemplate; context: {\n              rowIndex: rowIndex,\n              columnIndex: columnIndex,\n              active: rowIndex === worksheet.activeCellAddress.rowIndex && columnIndex === worksheet.activeCellAddress.columnIndex,\n              content: worksheet.cellContents[rowIndex] && worksheet.cellContents[rowIndex][columnIndex] || ''\n            }\">\n            </ng-content>\n          </ng-container>\n        </tr>\n      </tbody>\n    </table>\n\n    <ng-template\n      #cellTemplate\n      let-rowIndex=\"rowIndex\"\n      let-columnIndex=\"columnIndex\"\n      let-active=\"active\"\n      let-content=\"content\"\n    >\n      <td\n        [attr.data-row-index]=\"rowIndex\"\n        [attr.data-column-index]=\"columnIndex\"\n        [class.active]=\"active\"\n        (click)=\"worksheetOperations.setActiveCellAddress(rowIndex, columnIndex)\"\n      >\n        <input\n          *ngIf=\"active else inactive\"\n          [value]=\"content\"\n          (input)=\"worksheetOperations.setActiveCellContent($event.target.value)\"\n          appAutoFocus\n        >\n        <ng-template #inactive>{{content}}</ng-template>\n      </td>\n    </ng-template>\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class WorksheetComponent implements OnInit, OnDestroy {\n  readonly worksheet$ = this._worksheet.worksheet$\n  readonly worksheetOperations = this._worksheet.worksheetOperations\n  private readonly _worksheetKeyEventHandler = createWorksheetKeyEventHandler(this.worksheetOperations)\n\n  constructor(private readonly _worksheet: WorksheetService) {}\n\n  ngOnInit() {\n    window.addEventListener('keydown', this._worksheetKeyEventHandler)\n  }\n\n  ngOnDestroy() {\n    window.removeEventListener('keydown', this._worksheetKeyEventHandler)\n  }\n}\n","import { Injectable } from '@angular/core'\nimport produce from 'immer'\nimport { BehaviorSubject } from 'rxjs'\nimport { Worksheet, WorksheetOperations } from '../../../../usecase'\nimport createWorksheet from '../../../common/createWorksheet'\n\n@Injectable()\nexport class WorksheetService {\n  private readonly _worksheet = new BehaviorSubject<Worksheet>(createWorksheet())\n  readonly worksheetOperations = new WorksheetOperations(\n    mutate => this._worksheet.next(produce(this._worksheet.value, mutate))\n  )\n  readonly worksheet$ = this._worksheet.asObservable()\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false,\n}\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core'\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic'\n\nimport { AppModule } from './app/app.module'\nimport { environment } from './environments/environment'\n\nif (environment.production) {\n  enableProdMode()\n}\n\nplatformBrowserDynamic()\n  .bootstrapModule(AppModule)\n  .catch(err => console.error(err))\n"],"sourceRoot":""}